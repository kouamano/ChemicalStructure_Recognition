(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     31197,        718]
NotebookOptionsPosition[     28125,        656]
NotebookOutlinePosition[     28471,        671]
CellTagsIndexPosition[     28428,        668]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"basedir", "=", 
  "\"\</home/kamano/gitsrc/ChemicalStructureRecognition\>\""}]], "Input",
 CellChangeTimes->{{3.7893553982811403`*^9, 3.789355407724041*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"84eee3aa-e2af-44f8-8838-a60f499757dd"],

Cell[BoxData["\<\"/home/kamano/gitsrc/ChemicalStructureRecognition\"\>"], \
"Output",
 CellChangeTimes->{3.789355410618672*^9, 3.789355655110684*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"68c3f0dc-2a78-4e31-9649-ebd6621e774a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", "basedir", "]"}]], "Input",
 CellChangeTimes->{{3.7893299696358624`*^9, 3.789329994457827*^9}, {
  3.78935541802584*^9, 3.78935542027689*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"003adb4b-4d02-4242-a59a-5c2373a55008"],

Cell[BoxData["\<\"/home/kamano/gitsrc/ChemicalStructureRecognition\"\>"], \
"Output",
 CellChangeTimes->{3.789329996620461*^9, 3.789355421444565*^9, 
  3.789355659570826*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"9a16162a-5038-4391-a549-7eb5e4b32bdb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["OSRA check", "Section",
 CellChangeTimes->{{3.7893299475347357`*^9, 
  3.7893299593682327`*^9}},ExpressionUUID->"07abde65-6d73-4a78-a8f2-\
6ae1da791545"],

Cell[CellGroupData[{

Cell["Original data", "Subsection",
 CellChangeTimes->{{3.789355206912014*^9, 
  3.789355219348885*^9}},ExpressionUUID->"a77adfff-9066-4785-b9c4-\
0fb6b880ed35"],

Cell[BoxData[
 RowBox[{
  RowBox[{"files", "=", 
   RowBox[{
   "FileNames", "[", 
    "\"\</home/kamano/gitsrc/ChemicalStructureRecognition/OSRA-test/*\>\"", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.78933012210678*^9, 3.789330170033474*^9}, {
  3.789330210795466*^9, 3.7893302159056597`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"24d186d5-eec0-496e-8d48-23808f62ea97"],

Cell[BoxData[
 RowBox[{
  RowBox[{"smilesFile", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{"files", ",", 
     RowBox[{"a_String", "/;", 
      RowBox[{"StringMatchQ", "[", 
       RowBox[{"a", ",", "\"\<*txt\>\""}], "]"}]}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.7893302404400673`*^9, 3.789330245081208*^9}, {
  3.789330285866129*^9, 3.789330363498238*^9}, {3.789330503539254*^9, 
  3.789330589211357*^9}, {3.789330638221713*^9, 3.789330664960553*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"76d0c96b-32b5-4ae9-a30c-d09655f5a643"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IDs", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"StringReplace", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"RegularExpression", "[", "\"\<^.*/OSRA-test/\>\"", "]"}], 
          "\[Rule]", "\"\<\>\""}], ",", 
         RowBox[{"\"\<.txt\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}], 
     "&"}], ",", "smilesFile"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7893310515542593`*^9, 3.7893310924552383`*^9}, {
  3.7893554533880053`*^9, 3.789355453773862*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"d4c98b98-1ac0-48c6-8d1c-035218e97c3a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"11401\"\>", ",", "\<\"12604\"\>", ",", "\<\"13235\"\>", 
   ",", "\<\"13509\"\>", ",", "\<\"13838\"\>", ",", "\<\"15290\"\>", 
   ",", "\<\"15397\"\>", ",", "\<\"15657\"\>", ",", "\<\"16301\"\>", 
   ",", "\<\"1661\"\>", ",", "\<\"16933\"\>", ",", "\<\"17023\"\>", 
   ",", "\<\"17242\"\>", ",", "\<\"17538\"\>", ",", "\<\"19707\"\>", 
   ",", "\<\"1989\"\>", ",", "\<\"20008\"\>", ",", "\<\"21714\"\>", 
   ",", "\<\"21734\"\>", ",", "\<\"23711\"\>", ",", "\<\"24766\"\>", 
   ",", "\<\"26901\"\>", ",", "\<\"27756\"\>", ",", "\<\"28281\"\>", 
   ",", "\<\"28913\"\>", ",", "\<\"2945\"\>", ",", "\<\"29820\"\>", 
   ",", "\<\"3040\"\>", ",", "\<\"30646\"\>", ",", "\<\"32027\"\>", 
   ",", "\<\"32286\"\>", ",", "\<\"34262\"\>", ",", "\<\"35978\"\>", 
   ",", "\<\"37166\"\>", ",", "\<\"37508\"\>", ",", "\<\"37832\"\>", 
   ",", "\<\"38012\"\>", ",", "\<\"38397\"\>", ",", "\<\"39628\"\>", 
   ",", "\<\"40439\"\>", ",", "\<\"43288\"\>", ",", "\<\"43691\"\>", 
   ",", "\<\"5184\"\>", ",", "\<\"5540\"\>", ",", "\<\"5810\"\>", 
   ",", "\<\"7405\"\>", ",", "\<\"7486\"\>", ",", "\<\"8595\"\>", 
   ",", "\<\"8924\"\>", ",", "\<\"9910\"\>"}], "}"}]], "Output",
 CellChangeTimes->{3.789331093410021*^9, 3.789335818484668*^9, 
  3.7893504873952503`*^9, 3.789355237220175*^9, 3.7893554546924343`*^9, 
  3.789355664648732*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"a9f65409-a105-4762-bbe5-1327482d8938"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"smilesStr", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"#", ",", "\"\<String\>\""}], "]"}], "&"}], ",", 
     "smilesFile"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.789331469011713*^9, 3.789331495366146*^9}, {
  3.78933153218955*^9, 3.789331571038673*^9}, {3.7893377023905354`*^9, 
  3.789337718938115*^9}, {3.789350851421266*^9, 3.789350866299327*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"708e24e0-d2d4-4616-9207-043e4697aa7f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ChemicalData", "[", 
  RowBox[{"smilesStr", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.78935088006417*^9, 3.78935090994604*^9}, {
  3.789355273270651*^9, 3.7893552755243177`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"d3e1831c-1021-476d-af18-ce875ea05ff3"],

Cell[BoxData[
 GraphicsBox[{{
    {RGBColor[0.800498, 0.201504, 0.192061], AbsoluteThickness[0.55], InsetBox[
      StyleBox["\<\"O\"\>",
       StripOnInput->False,
       ScriptSizeMultipliers->0.8,
       ScriptMinSize->8,
       FontSize->Scaled[0.03898940941613314],
       FontWeight->Plain], {859.91, 25.}], 
     LineBox[{{841.4575220278103, 14.34614435785815}, {816.61, 0.}}], 
     {RGBColor[0.4, 0.4, 0.4], 
      LineBox[{{816.61, 0.}, {773.3100000000001, -25.}}]}}, 
    {RGBColor[0.800498, 0.201504, 0.192061], AbsoluteThickness[0.55], InsetBox[
      StyleBox["\<\"O\"\>",
       StripOnInput->False,
       ScriptSizeMultipliers->0.8,
       ScriptMinSize->8,
       FontSize->Scaled[0.03898940941613314],
       FontWeight->Plain], {859.91, 25.}], 
     LineBox[{{878.3623061210458, 14.34584671722067}, {886.7549999999999, 
      9.5}}], 
     {RGBColor[0.43333333333333335`, 0.4666666666666667, 0.4666666666666667], 
      InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        ScriptSizeMultipliers->0.8,
        ScriptMinSize->8,
        FontSize->Scaled[0.03898940941613314],
        FontWeight->Plain], {913.5999999999999, -6.}], 
      LineBox[{{886.7549999999999, 9.5}, {896.5471962486223, 
       3.8460964107413833`}}]}}, 
    {RGBColor[0.800498, 0.201504, 0.192061], AbsoluteThickness[0.55], InsetBox[
      StyleBox["\<\"O\"\>",
       StripOnInput->False,
       ScriptSizeMultipliers->0.8,
       ScriptMinSize->8,
       FontSize->Scaled[0.03898940941613314],
       FontWeight->Plain], {253.69000000000003, -25.}], 
     LineBox[{{272.1430106192158, -14.347066955769689`}, {296.995, 0.}}], 
     {RGBColor[0.4, 0.4, 0.4], LineBox[{{296.995, 0.}, {340.3, 25.}}]}}, 
    {RGBColor[0.800498, 0.201504, 0.192061], AbsoluteThickness[0.55], InsetBox[
      StyleBox["\<\"O\"\>",
       StripOnInput->False,
       ScriptSizeMultipliers->0.8,
       ScriptMinSize->8,
       FontSize->Scaled[0.03898940941613314],
       FontWeight->Plain], {253.69000000000003, -25.}], 
     LineBox[{{235.2376938789542, -14.345846717220697`}, {
      226.84500000000003`, -9.5}}], 
     {RGBColor[0.43333333333333335`, 0.4666666666666667, 0.4666666666666667], 
      InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        ScriptSizeMultipliers->0.8,
        ScriptMinSize->8,
        FontSize->Scaled[0.03898940941613314],
        FontWeight->Plain], {200., 6.}], 
      LineBox[{{226.84500000000003`, -9.5}, {
       217.0528037513776, -3.8460964107413833`}}]}}, 
    {RGBColor[0.800498, 0.201504, 0.192061], AbsoluteThickness[0.55], InsetBox[
      StyleBox["\<\"O\"\>",
       StripOnInput->False,
       ScriptSizeMultipliers->0.8,
       ScriptMinSize->8,
       FontSize->Scaled[0.03898940941613314],
       FontWeight->Plain], {773.3100000000001, -125.}], 
     LineBox[{{{768.3100000000001, -103.69275749052115`}, {
      768.3100000000001, -75.}}, {{778.3100000000001, -103.69275749052115`}, {
      778.3100000000001, -75.}}}], 
     {RGBColor[0.4, 0.4, 0.4], 
      LineBox[{{{768.3100000000001, -75.}, {768.3100000000001, -25.}}, {{
       778.3100000000001, -75.}, {778.3100000000001, -25.}}}]}}, 
    {RGBColor[0.800498, 0.201504, 0.192061], AbsoluteThickness[0.55], InsetBox[
      StyleBox["\<\"O\"\>",
       StripOnInput->False,
       ScriptSizeMultipliers->0.8,
       ScriptMinSize->8,
       FontSize->Scaled[0.03898940941613314],
       FontWeight->Plain], {340.3, 125.}], 
     LineBox[{{{345.3, 103.69275749052115`}, {345.3, 75.}}, {{335.3, 
      103.69275749052115`}, {335.3, 75.}}}], 
     {RGBColor[0.4, 0.4, 0.4], 
      LineBox[{{{345.3, 75.}, {345.3, 25.}}, {{335.3, 75.}, {335.3, 25.}}}]}}, 
    {RGBColor[0.4, 0.4, 0.4], AbsoluteThickness[0.55], 
     LineBox[{{600.1, -25.}, {556.8, 0.}}], 
     {RGBColor[0.4, 0.4, 0.4], LineBox[{{556.8, 0.}, {513.5, 25.}}]}}, 
    {RGBColor[0.4, 0.4, 0.4], AbsoluteThickness[0.55], 
     LineBox[{{600.1, -25.}, {643.405, 0.}}], 
     {RGBColor[0.4, 0.4, 0.4], 
      LineBox[{{643.405, 0.}, {686.7099999999999, 25.}}]}}, 
    {RGBColor[0.4, 0.4, 0.4], AbsoluteThickness[0.55], 
     LineBox[{{600.1, -25.}, {600.1, -75.}}], 
     {RGBColor[0.4, 0.4, 0.4], LineBox[{{600.1, -75.}, {600.1, -125.}}]}}, 
    {RGBColor[0.4, 0.4, 0.4], AbsoluteThickness[0.55], 
     LineBox[{{513.5, 25.}, {470.20000000000005`, 0.}}], 
     {RGBColor[0.4, 0.4, 0.4], 
      LineBox[{{470.20000000000005`, 0.}, {426.90000000000003`, -25.}}]}}, 
    {RGBColor[0.4, 0.4, 0.4], AbsoluteThickness[0.55], 
     LineBox[{{686.7099999999999, 25.}, {730.01, 0.}}], 
     {RGBColor[0.4, 0.4, 0.4], 
      LineBox[{{730.01, 0.}, {773.3100000000001, -25.}}]}}, 
    {RGBColor[0.4, 0.4, 0.4], AbsoluteThickness[0.55], 
     LineBox[{{426.90000000000003`, -25.}, {383.6, 0.}}], 
     {RGBColor[0.4, 0.4, 0.4], 
      LineBox[{{383.6, 0.}, {340.3, 25.}}]}}}, {}, {}},
  ImageSize->{{0., 283.4134182073552}, {0., 113.35755729442577`}},
  PlotRange->{{180., 933.5999999999999}, {-154.38241893599792`, 
   147.03681420199845`}}]], "Output",
 CellChangeTimes->{3.789355276330099*^9, 3.7893556742061367`*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"4fea46d4-c462-450b-9a6e-72a9f121c7c1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ChemicalData", "[", 
  RowBox[{
   RowBox[{"smilesStr", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<AdjacencyMatrix\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.78935088006417*^9, 3.78935090994604*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"64cea180-e880-4d9d-8f0d-4a2e4f47f573"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource[
               "FEBitmaps", "SquarePlusIconMedium"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              Evaluator -> Automatic, Method -> "Preemptive"], 
             Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGAQh2IQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtn//Vb6
YI7gJXv+2SfOsOo9tb9UcOpOjfJ7e1zqR8WHt/hoehgVHwnio+l8VHw0nYyK
j6aHUfHRdDIqPppORsUHg/hoehgVH00no+Kj6WFUfDSdjIqPpodRcXrG785u
A9edW17Y33Bfvq5m2lv7kxG5/+K/0j49jKbDkZkeRuN9VHwwpIfhmg5x+Wuo
+HeouHOwhc9Qj/ehkk4Gm73DNX6HSnwNlPmj8T4yy9vReB8Vp2d/bVR8aImP
podR8dH6ZTR8Rv07OMMHAOTPUfQ=
              "], {{0, 0}, {23, 23}}, {0, 1}], 
             AspectRatio -> 1, Axes -> False, Frame -> False, 
             FrameLabel -> {None, None}, FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}], 
             Method -> {
              "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
               Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["44", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"23", ",", "23"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource[
               "FEBitmaps", "SquareMinusIconMedium"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              Evaluator -> Automatic, Method -> "Preemptive"], 
             Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGAQh2IQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtn//Vb6
YI7gJXv+2SfOsOo9tb9UcOpOjfJ7e1zqR8WHt/hoehgVHwnio+l8VHw0nYyK
j6aHUfHRdDIqPppORsUHg/hoehgVH00no+Kj6WFUfDSdjIqPpodRcXrG785u
A9edW17Y33Bfvq5m2lv7kxG5/+K/0j49jKbDkZkeRuN9VHwwpIfhmg5x+Wuo
+HeouHOwhc9Qj/ehkk4Gm73DNX6HSnwNlPmj8T4yy9vReB8Vp2d/bVR8aImP
podR8dH6ZTR8Rv07OMMHAOTPUfQ=
              "], {{0, 0}, {23, 23}}, {0, 1}], 
             AspectRatio -> 1, Axes -> False, Frame -> False, 
             FrameLabel -> {None, None}, FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}], 
             Method -> {
              "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
               Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["44", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"23", ",", "23"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0.0831758034026465`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "10"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "22"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "11"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "23"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {23, 23}, 0, {
   1, {{0, 2, 4, 5, 6, 10, 14, 18, 22, 26, 29, 32, 33, 34, 35, 36, 37, 38, 39,
      40, 41, 42, 43, 44}, {{10}, {22}, {11}, {23}, {10}, {11}, {6}, {7}, {
     8}, {12}, {9}, {13}, {14}, {5}, {10}, {15}, {16}, {5}, {17}, {18}, {
     19}, {5}, {11}, {20}, {21}, {6}, {1}, {3}, {7}, {2}, {4}, {9}, {5}, {
     6}, {6}, {7}, {7}, {8}, {8}, {8}, {9}, {9}, {1}, {2}}}, {1, 1, 1, 1, 2, 
    2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1,
     2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{{3.789350877214766*^9, 3.789350911048503*^9}, 
   3.789355247498663*^9, 3.789355675171652*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"676ca361-7bd1-4e0d-b110-24b25758c245"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["OSRA Smiles from jpg", "Subsection",
 CellChangeTimes->{{3.789355346391924*^9, 
  3.789355377196309*^9}},ExpressionUUID->"d5de47ce-d6b2-44ba-82f0-\
39b370759789"],

Cell[BoxData[
 RowBox[{
  RowBox[{"jpgSmilesFile", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
      "basedir", "<>", "\"\</OSRA-test/\>\"", "<>", "#", "<>", 
       "\"\<.jpg.os\>\""}], "&"}], ",", "IDs"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.789355439943427*^9, 3.789355442660677*^9}, {
  3.7893556824871683`*^9, 3.7893558431198397`*^9}, {3.789355933420381*^9, 
  3.7893559624442797`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"4d7bf0ce-bea5-4840-87a2-9fa98d7f2678"],

Cell[BoxData[
 RowBox[{
  RowBox[{"jpgSmiles", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"#", ",", "\"\<String\>\""}], "]"}], "&"}], ",", 
     "jpgSmilesFile"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.789355860422974*^9, 3.789355883199931*^9}, {
  3.789355966608049*^9, 3.789355976656651*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"9be69847-d914-4ab4-bb6f-1c5ba921aa29"]
}, Open  ]],

Cell[CellGroupData[{

Cell["OSRA Smiles from png", "Subsection",
 CellChangeTimes->{{3.789355346391924*^9, 3.789355377196309*^9}, {
  3.789355996223917*^9, 
  3.789355997671713*^9}},ExpressionUUID->"8eb44cad-aac3-44fd-a98b-\
8de46ae67ac4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ongSmilesFile", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
      "basedir", "<>", "\"\</OSRA-test/\>\"", "<>", "#", "<>", 
       "\"\<.png.os\>\""}], "&"}], ",", "IDs"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.789355439943427*^9, 3.789355442660677*^9}, {
  3.7893556824871683`*^9, 3.7893558431198397`*^9}, {3.789355933420381*^9, 
  3.7893559624442797`*^9}, {3.789356002675737*^9, 3.789356010056712*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"3f39aa19-66ff-41fd-9e4f-b91145ab1cfd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pngSmiles", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"#", ",", "\"\<String\>\""}], "]"}], "&"}], ",", 
     "jpgSmilesFile"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.789355860422974*^9, 3.789355883199931*^9}, {
  3.789355966608049*^9, 3.789355976656651*^9}, {3.7893560124680443`*^9, 
  3.7893560158006372`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"fd643d97-0532-4e78-be2d-ca3e13d08be3"],

Cell[CellGroupData[{

Cell[BoxData["pngSmiles"], "Input",
 CellLabel->"In[25]:=",ExpressionUUID->"3818b579-92dc-42ee-a66d-b31e23520f6f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"OC(=[U])CCC(CC(=N)O)C\\n\"\>", ",", "\<\"\"\>", 
   ",", "\<\"S=C1CC2C(C1(C)CC2)(C)C\\n\"\>", 
   ",", "\<\"c1ccc(cc1)Oc1ccccc1\\n\"\>", 
   ",", "\<\"O=[NH+]c1[nH]c(=O)[nH]c(=O)c1N\\n\"\>", 
   ",", "\<\"O=C=Nc1ccc(cc1OC)OC\\n\"\>", 
   ",", "\<\"COc1nc(Cl)nc(n1)Cl\\n\"\>", 
   ",", "\<\"ClP(C(C)(C)C)C(C)(C)C\\n\"\>", ",", "\<\"\"\>", ",", "\<\"\"\>", 
   ",", "\<\"\"\>", ",", "\<\"CCCON(OCCC)OCCC\\n\"\>", 
   ",", "\<\"Sc1cccc(c1)Br\\n\"\>", ",", "\<\"\"\>", 
   ",", "\<\"[O-][N+](=O)Cc1cccc(c1)S(=O)(=O)N\\n\"\>", 
   ",", "\<\"CCC(C=C)(F)F\\n\"\>", ",", "\<\"\"\>", 
   ",", "\<\"Fc1ccccc1C(Cl)(Cl)Cl\\n\"\>", 
   ",", "\<\"CN(CCC(=O)c1ccccc1)C\\n\"\>", ",", "\<\"\"\>", 
   ",", "\<\"c1ccc2c(c1)cc1c(c2)sc2c1cccc2\\n\"\>", 
   ",", "\<\"O=C(C1CCCC=C1)CCCC(=O)c1ccccc1\\n\"\>", ",", "\<\"\"\>", 
   ",", "\<\"c1[c-]cc(cc1)CN1CCCC1\\n\"\>", ",", "\<\"\"\>", 
   ",", "\<\"Cc1ccc(cc1)O\\n\"\>", 
   ",", "\<\"N=C/C(=C(\\\\c1ccccc1)/C1CC=CC=C1)/c1ccccc1\\n\"\>", 
   ",", "\<\"Cc1cccc(=O)[nH]1\\n\"\>", 
   ",", "\<\"CCO[C](=CC)(Oc1ccc(cc1)[N+](=O)[O-])OCC\\n\"\>", 
   ",", "\<\"C*CCC(c1ccccc1)OC1=CC=C(CC1)C(F)(F)F\\n\"\>", ",", "\<\"\"\>", 
   ",", "\<\"OCC12CCCC(C2C(C23C1CCC(C3)C(=C)C2)C(=O)C)(C)C(=O)[O-]\\n\"\>", 
   ",", "\<\"\"\>", 
   ",", "\<\"OC1CCC2(C(C1)C(O)CC1C2CCC2(C1CCC2C(CCC(C(C)C)C)C)C)C\\n\"\>", 
   ",", "\<\"*COC1C(*C(C2CCC=CC2)CN)OC(C(C1O)O)COC1OCC(C(C1O*)O)O\\n\"\>", 
   ",", "\<\"\"\>", 
   ",", "\<\"CC/C=C/1\\\\C=CC(C=C1)CCCC1CCC(C=C1)C[I+]\\n\"\>", 
   ",", "\<\"CCC(C(C(C(C(C(C(C(CO)(F)C)(F)C)(F)C)(F)*)(I)C)(F)C)(F)C)(F)*\\n\"\
\>", ",", "\<\"CCC1CCCC([C@H]1C)CCC(CCCC(CCCC(CCCC(CCCC(CCCC(C)C)C)C)C)C)C\\n\
\"\>", ",", \
"\<\"CO[C]1(=C)OC2C3C(=CC(=C2c2c(O1)c1c(cc2c2ccccc2)ccc2c1cccc2)c1ccccc1)C=\
Cc1c3cccc1\\n\"\>", ",", "\<\"\"\>", ",", "\<\"\"\>", ",", "\<\"\"\>", 
   ",", "\<\"\"\>", ",", "\<\"\"\>", ",", "\<\"IOc1cc(O)c(cc1C)O\\n\"\>", 
   ",", "\<\"CCCC(CC[I]=N)CC\\n\"\>", ",", "\<\"O=C1CCCc2c1cccc2\\n\"\>", 
   ",", "\<\"\"\>", ",", "\<\"\"\>"}], "}"}]], "Output",
 CellChangeTimes->{3.78935603056032*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"fcf52460-0be2-45dd-a24b-e9ca616c8bf1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["memo", "Subsection",
 CellChangeTimes->{{3.789331137169704*^9, 
  3.789331153501441*^9}},ExpressionUUID->"1da3c038-b401-4d17-8cbd-\
f89ae9240e48"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"smilesFile", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"RegularExpression", "[", "\"\<^.*/OSRA-test/\>\"", "]"}], 
      "\[Rule]", "\"\<\>\""}], ",", 
     RowBox[{"\"\<.txt\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.78933078650071*^9, 3.789330850268939*^9}, {
  3.7893309236978207`*^9, 3.789331013926159*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"7fcd3637-eef8-441d-a5ec-f69ca597ec57"],

Cell[BoxData["\<\"11401\"\>"], "Output",
 CellChangeTimes->{
  3.789330790648951*^9, {3.789330837663979*^9, 3.789330851449444*^9}, {
   3.789330930284904*^9, 3.7893310150390377`*^9}, 3.789335830989993*^9, 
   3.7893505031063347`*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"3ccc7cf9-f7b5-4f8a-8f43-00515124b80d"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 911},
WindowMargins->{{382, Automatic}, {58, Automatic}},
FrontEndVersion->"12.0 for Linux x86 (64-bit) (2019\:5e745\:67083\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 259, 4, 31, "Input",ExpressionUUID->"84eee3aa-e2af-44f8-8838-a60f499757dd"],
Cell[842, 28, 227, 3, 35, "Output",ExpressionUUID->"68c3f0dc-2a78-4e31-9649-ebd6621e774a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1106, 36, 264, 4, 50, "Input",ExpressionUUID->"003adb4b-4d02-4242-a59a-5c2373a55008"],
Cell[1373, 42, 252, 4, 35, "Output",ExpressionUUID->"9a16162a-5038-4391-a549-7eb5e4b32bdb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1662, 51, 159, 3, 68, "Section",ExpressionUUID->"07abde65-6d73-4a78-a8f2-6ae1da791545"],
Cell[CellGroupData[{
Cell[1846, 58, 161, 3, 55, "Subsection",ExpressionUUID->"a77adfff-9066-4785-b9c4-0fb6b880ed35"],
Cell[2010, 63, 383, 9, 50, "Input",ExpressionUUID->"24d186d5-eec0-496e-8d48-23808f62ea97"],
Cell[2396, 74, 546, 12, 50, "Input",ExpressionUUID->"76d0c96b-32b5-4ae9-a30c-d09655f5a643"],
Cell[CellGroupData[{
Cell[2967, 90, 647, 16, 75, "Input",ExpressionUUID->"d4c98b98-1ac0-48c6-8d1c-035218e97c3a"],
Cell[3617, 108, 1445, 22, 128, "Output",ExpressionUUID->"a9f65409-a105-4762-bbe5-1327482d8938"]
}, Open  ]],
Cell[5077, 133, 534, 12, 50, "Input",ExpressionUUID->"708e24e0-d2d4-4616-9207-043e4697aa7f"],
Cell[CellGroupData[{
Cell[5636, 149, 318, 6, 50, "Input",ExpressionUUID->"d3e1831c-1021-476d-af18-ce875ea05ff3"],
Cell[5957, 157, 5169, 109, 130, "Output",ExpressionUUID->"4fea46d4-c462-450b-9a6e-72a9f121c7c1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11163, 271, 317, 7, 50, "Input",ExpressionUUID->"64cea180-e880-4d9d-8f0d-4a2e4f47f573"],
Cell[11483, 280, 10693, 219, 67, "Output",ExpressionUUID->"676ca361-7bd1-4e0d-b110-24b25758c245"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[22225, 505, 168, 3, 55, "Subsection",ExpressionUUID->"d5de47ce-d6b2-44ba-82f0-39b370759789"],
Cell[22396, 510, 510, 12, 50, "Input",ExpressionUUID->"4d7bf0ce-bea5-4840-87a2-9fa98d7f2678"],
Cell[22909, 524, 442, 11, 50, "Input",ExpressionUUID->"9be69847-d914-4ab4-bb6f-1c5ba921aa29"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23388, 540, 217, 4, 55, "Subsection",ExpressionUUID->"8eb44cad-aac3-44fd-a98b-8de46ae67ac4"],
Cell[23608, 546, 556, 12, 50, "Input",ExpressionUUID->"3f39aa19-66ff-41fd-9e4f-b91145ab1cfd"],
Cell[24167, 560, 495, 12, 50, "Input",ExpressionUUID->"fd643d97-0532-4e78-be2d-ca3e13d08be3"],
Cell[CellGroupData[{
Cell[24687, 576, 114, 1, 31, "Input",ExpressionUUID->"3818b579-92dc-42ee-a66d-b31e23520f6f"],
Cell[24804, 579, 2178, 38, 806, "Output",ExpressionUUID->"fcf52460-0be2-45dd-a24b-e9ca616c8bf1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27031, 623, 152, 3, 55, "Subsection",ExpressionUUID->"1da3c038-b401-4d17-8cbd-f89ae9240e48"],
Cell[CellGroupData[{
Cell[27208, 630, 563, 14, 93, "Input",ExpressionUUID->"7fcd3637-eef8-441d-a5ec-f69ca597ec57"],
Cell[27774, 646, 311, 5, 35, "Output",ExpressionUUID->"3ccc7cf9-f7b5-4f8a-8f43-00515124b80d"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

